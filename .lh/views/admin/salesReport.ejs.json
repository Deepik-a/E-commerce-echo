{
    "sourceFile": "views/admin/salesReport.ejs",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 14,
            "patches": [
                {
                    "date": 1736310863953,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1736311160233,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,106 +1,7 @@\n \r\n+<%- include('sidebar.ejs') %>\r\n \r\n-<div class=\"flex ml-64\">\r\n- \r\n-  \r\n-  <div class=\"container mx-auto px-4 py-8 flex-1\">\r\n-    <div class=\"mb-6\">\r\n-      <div class=\"flex justify-between items-center mb-6\">\r\n-        <h1 class=\"text-2xl font-semibold text-gray-800\">Sales Report</h1>\r\n-        \r\n-        <div class=\"flex gap-4\">\r\n-          <!-- Filter Dropdown -->\r\n-          <div class=\"relative\">\r\n-            <select id=\"filterOption\" class=\"bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n-              <option value=\"\">Filter</option>\r\n-              <option value=\"day\">This Day</option>\r\n-              <option value=\"week\">This Week</option>\r\n-              <option value=\"month\">This Month</option>\r\n-              <option value=\"year\">This Year</option>\r\n-            </select>\r\n-          </div>\r\n-          \r\n-          <!-- Export Dropdown -->\r\n-          <div class=\"relative\">\r\n-            <select id=\"export\" class=\"bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n-              <option value=\"\">Export Report</option>\r\n-              <option value=\"excel\">Excel Sheet</option>\r\n-              <option value=\"pdf\">PDF</option>\r\n-            </select>\r\n-          </div>\r\n-        </div>\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <div class=\"bg-white h-28 flex justify-between items-center my-6 px-4 py-5 shadow-lg rounded-lg space-x-6\">\r\n-      <div class=\"flex-1 px-5 py-3 bg-gray-100 rounded-md flex flex-col justify-center items-center text-gray-700 font-medium shadow-sm hover:bg-gray-200 transition duration-300 ease-in-out\">\r\n-        <span class=\"text-xs uppercase tracking-wider text-gray-500\">Overall Sales Count</span>\r\n-        <span id=\"overallSalesCount\" class=\"text-2xl font-semibold mt-1\"><%= overallSalesCount %></span>\r\n-      </div>\r\n-      <div class=\"flex-1 px-5 py-3 bg-gray-100 rounded-md flex flex-col justify-center items-center text-gray-700 font-medium shadow-sm hover:bg-gray-200 transition duration-300 ease-in-out\">\r\n-        <span class=\"text-xs uppercase tracking-wider text-gray-500\">Overall Order Amount</span>\r\n-        <span id=\"overallOrderAmount\" class=\"text-2xl font-semibold mt-1\">₹ <%= overallOrderAmount.toFixed(2) %></span>\r\n-      </div>\r\n-      <div class=\"flex-1 px-5 py-3 bg-gray-100 rounded-md flex flex-col justify-center items-center text-gray-700 font-medium shadow-sm hover:bg-gray-200 transition duration-300 ease-in-out\">\r\n-        <span class=\"text-xs uppercase tracking-wider text-gray-500\">Overall Coupon Discount</span>\r\n-        <span id=\"totalCouponDiscount\" class=\"text-2xl font-semibold mt-1\">₹ <%= totalCouponDiscount.toFixed(2) %></span>\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <!-- Sales Report Table -->\r\n-    <div class=\"bg-white rounded-lg shadow-md overflow-x-auto\">\r\n-      <table class=\"min-w-full divide-y divide-gray-200\">\r\n-        <thead class=\"bg-gray-50\">\r\n-          <tr>\r\n-            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Order ID</th>\r\n-            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">User ID</th>\r\n-            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Order Date</th>\r\n-            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Order Amount</th>\r\n-            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Coupon Deduction</th>\r\n-            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Payment Status</th>\r\n-            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Payment Method</th>\r\n-          </tr>\r\n-        </thead>\r\n-        <tbody class=\"bg-white divide-y divide-gray-200\">\r\n-          <% data.forEach(data =>{ %>\r\n-          <tr class=\"hover:bg-gray-50\">\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= data.orderId %></td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= data.userId.toString().substring(0, 4) + '...' + data.userId.toString().slice(-5) %></td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= new Date(data.createdAt).toLocaleDateString('en-GB') %></td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">₹ <%= data.payableAmount.toFixed(2) %></td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">₹ <%= data.couponDiscount.toFixed(2) %></td>\r\n-            <td class=\"px-6 py-4 text-sm\">\r\n-              <span class=\"<%= data.status === 'Paid'%>px-6 py-4 text-sm text-gray-600\">\r\n-                <%= data.status %>\r\n-              </span>\r\n-            </td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= data.paymentMethod %></td>\r\n-   \r\n-          </tr>\r\n-          <% }) %>\r\n-        </tbody>\r\n-      </table>\r\n-    </div>\r\n-\r\n-    <!-- Pagination -->\r\n-    <div class=\"flex justify-between items-center mt-6\">\r\n-      <div class=\"text-sm text-gray-600\">\r\n-        Showing <span class=\"font-medium\" id=\"currentPage\"><%= currentPage %></span> to \r\n-        <span class=\"font-medium\" id=\"totalPages\"><%= totalPages %></span> of \r\n-        <span class=\"font-medium\" id=\"totalRecords\"><%= totalRecordsCount %></span> results\r\n-      </div>\r\n-      <div class=\"inline-flex gap-2\">\r\n-        <button id=\"prevPage\" class=\"px-4 py-2 border border-gray-300 rounded-md text-gray-600 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n-          Previous\r\n-        </button>\r\n-        <button id=\"nextPage\" class=\"px-4 py-2 border border-gray-300 rounded-md text-gray-600 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n-          Next\r\n-        </button>\r\n-      </div>\r\n-    </div>\r\n-  </div>\r\n-</div>\r\n     <script>\r\n      let currentPage = parseInt(document.getElementById('currentPage').innerHTML);\r\n       let totalPages = parseInt(document.getElementById('totalPages').innerHTML);\r\n       let overallSalesCount = document.getElementById('overallSalesCount');\r\n"
                },
                {
                    "date": 1736311245008,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,219 @@\n \r\n <%- include('sidebar.ejs') %>\r\n+<!DOCTYPE html>\r\n+<html lang=\"en\">\r\n+<head>\r\n+  <meta charset=\"UTF-8\">\r\n+  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+  <title>Sales Report</title>\r\n+  <style>\r\n+    /* Base styles */\r\n+    body {\r\n+      margin: 0;\r\n+      font-family: system-ui, -apple-system, sans-serif;\r\n+      background-color: #f3f4f6;\r\n+    }\r\n \r\n+    /* Sidebar styles */\r\n+    .sidebar {\r\n+      position: fixed;\r\n+      left: 0;\r\n+      top: 0;\r\n+      height: 100vh;\r\n+      width: 256px;\r\n+      background-color: #e6f3ff;\r\n+      transition: transform 0.3s ease;\r\n+      z-index: 40;\r\n+    }\r\n+\r\n+    /* Main content styles */\r\n+    .main-content {\r\n+      margin-left: 256px;\r\n+      transition: margin-left 0.3s ease;\r\n+      min-height: 100vh;\r\n+      background-color: #f3f4f6;\r\n+    }\r\n+\r\n+    /* Toggle button */\r\n+    .toggle-btn {\r\n+      display: none;\r\n+      position: fixed;\r\n+      top: 1rem;\r\n+      left: 1rem;\r\n+      z-index: 50;\r\n+      padding: 0.5rem;\r\n+      background-color: #3b82f6;\r\n+      color: white;\r\n+      border: none;\r\n+      border-radius: 0.375rem;\r\n+      cursor: pointer;\r\n+    }\r\n+\r\n+    /* Stats cards */\r\n+    .stats-card {\r\n+      background-color: #e6f3ff;\r\n+      padding: 1.25rem;\r\n+      border-radius: 0.5rem;\r\n+      flex: 1;\r\n+      text-align: center;\r\n+      transition: background-color 0.3s;\r\n+    }\r\n+\r\n+    .stats-card:hover {\r\n+      background-color: #bfdbfe;\r\n+    }\r\n+\r\n+    /* Table styles */\r\n+    .table-container {\r\n+      background-color: white;\r\n+      border-radius: 0.5rem;\r\n+      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n+      overflow-x: auto;\r\n+    }\r\n+\r\n+    /* Responsive styles */\r\n+    @media (max-width: 1024px) {\r\n+      .sidebar {\r\n+        transform: translateX(-100%);\r\n+      }\r\n+      \r\n+      .sidebar.active {\r\n+        transform: translateX(0);\r\n+      }\r\n+\r\n+      .main-content {\r\n+        margin-left: 0;\r\n+      }\r\n+\r\n+      .toggle-btn {\r\n+        display: block;\r\n+      }\r\n+\r\n+      .stats-container {\r\n+        flex-direction: column;\r\n+      }\r\n+\r\n+      .stats-card {\r\n+        margin-bottom: 1rem;\r\n+      }\r\n+    }\r\n+  </style>\r\n+</head>\r\n+<body>\r\n+  <button class=\"toggle-btn\" onclick=\"toggleSidebar()\">☰</button>\r\n+  \r\n+  <div class=\"sidebar\">\r\n+    <!-- Sidebar content goes here -->\r\n+  </div>\r\n+\r\n+  <div class=\"main-content\">\r\n+    <div class=\"container mx-auto px-4 py-8\">\r\n+      <div class=\"mb-6\">\r\n+        <div class=\"flex flex-wrap justify-between items-center mb-6\">\r\n+          <h1 style=\"font-size: 1.5rem; font-weight: 600; color: #1f2937;\">Sales Report</h1>\r\n+          \r\n+          <div class=\"flex flex-wrap gap-4 mt-4 sm:mt-0\">\r\n+            <select id=\"filterOption\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white;\">\r\n+              <option value=\"\">Filter</option>\r\n+              <option value=\"day\">This Day</option>\r\n+              <option value=\"week\">This Week</option>\r\n+              <option value=\"month\">This Month</option>\r\n+              <option value=\"year\">This Year</option>\r\n+            </select>\r\n+            \r\n+            <select id=\"export\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white;\">\r\n+              <option value=\"\">Export Report</option>\r\n+              <option value=\"excel\">Excel Sheet</option>\r\n+              <option value=\"pdf\">PDF</option>\r\n+            </select>\r\n+          </div>\r\n+        </div>\r\n+      </div>\r\n+\r\n+      <div class=\"flex flex-wrap gap-4 my-6\">\r\n+        <div class=\"stats-card\">\r\n+          <span style=\"font-size: 0.75rem; text-transform: uppercase; color: #6b7280;\">Overall Sales Count</span>\r\n+          <span id=\"overallSalesCount\" style=\"display: block; font-size: 1.5rem; font-weight: 600; margin-top: 0.25rem;\"><%= overallSalesCount %></span>\r\n+        </div>\r\n+        \r\n+        <div class=\"stats-card\">\r\n+          <span style=\"font-size: 0.75rem; text-transform: uppercase; color: #6b7280;\">Overall Order Amount</span>\r\n+          <span id=\"overallOrderAmount\" style=\"display: block; font-size: 1.5rem; font-weight: 600; margin-top: 0.25rem;\">₹ <%= overallOrderAmount.toFixed(2) %></span>\r\n+        </div>\r\n+        \r\n+        <div class=\"stats-card\">\r\n+          <span style=\"font-size: 0.75rem; text-transform: uppercase; color: #6b7280;\">Overall Coupon Discount</span>\r\n+          <span id=\"totalCouponDiscount\" style=\"display: block; font-size: 1.5rem; font-weight: 600; margin-top: 0.25rem;\">₹ <%= totalCouponDiscount.toFixed(2) %></span>\r\n+        </div>\r\n+      </div>\r\n+\r\n+      <div class=\"table-container\">\r\n+        <table style=\"min-width: 100%; border-collapse: separate; border-spacing: 0;\">\r\n+          <thead style=\"background-color: #f9fafb;\">\r\n+            <tr>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Order ID</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">User ID</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Order Date</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Order Amount</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Coupon Deduction</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Payment Status</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Payment Method</th>\r\n+            </tr>\r\n+          </thead>\r\n+          <tbody>\r\n+            <% data.forEach(data =>{ %>\r\n+            <tr style=\"border-bottom: 1px solid #e5e7eb;\">\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.orderId %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.userId.toString().substring(0, 4) + '...' + data.userId.toString().slice(-5) %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= new Date(data.createdAt).toLocaleDateString('en-GB') %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\">₹ <%= data.payableAmount.toFixed(2) %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\">₹ <%= data.couponDiscount.toFixed(2) %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.status %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.paymentMethod %></td>\r\n+            </tr>\r\n+            <% }) %>\r\n+          </tbody>\r\n+        </table>\r\n+      </div>\r\n+\r\n+      <div class=\"flex flex-wrap justify-between items-center mt-6\">\r\n+        <div style=\"font-size: 0.875rem; color: #4b5563;\">\r\n+          Showing <span style=\"font-weight: 500;\" id=\"currentPage\"><%= currentPage %></span> to \r\n+          <span style=\"font-weight: 500;\" id=\"totalPages\"><%= totalPages %></span> of \r\n+          <span style=\"font-weight: 500;\" id=\"totalRecords\"><%= totalRecordsCount %></span> results\r\n+        </div>\r\n+        <div class=\"flex gap-2 mt-4 sm:mt-0\">\r\n+          <button id=\"prevPage\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; color: #4b5563;\">\r\n+            Previous\r\n+          </button>\r\n+          <button id=\"nextPage\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; color: #4b5563;\">\r\n+            Next\r\n+          </button>\r\n+        </div>\r\n+      </div>\r\n+    </div>\r\n+  </div>\r\n+\r\n+  <script>\r\n+    function toggleSidebar() {\r\n+      document.querySelector('.sidebar').classList.toggle('active');\r\n+    }\r\n+\r\n+    // Close sidebar when clicking outside on mobile\r\n+    document.addEventListener('click', function(event) {\r\n+      const sidebar = document.querySelector('.sidebar');\r\n+      const toggleBtn = document.querySelector('.toggle-btn');\r\n+      \r\n+      if (window.innerWidth <= 1024 && \r\n+          !sidebar.contains(event.target) && \r\n+          !toggleBtn.contains(event.target) && \r\n+          sidebar.classList.contains('active')) {\r\n+        sidebar.classList.remove('active');\r\n+      }\r\n+    });\r\n+  </script>\r\n+\r\n     <script>\r\n      let currentPage = parseInt(document.getElementById('currentPage').innerHTML);\r\n       let totalPages = parseInt(document.getElementById('totalPages').innerHTML);\r\n       let overallSalesCount = document.getElementById('overallSalesCount');\r\n"
                },
                {
                    "date": 1736311280469,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -193,27 +193,10 @@\n       </div>\r\n     </div>\r\n   </div>\r\n \r\n-  <script>\r\n-    function toggleSidebar() {\r\n-      document.querySelector('.sidebar').classList.toggle('active');\r\n-    }\r\n \r\n-    // Close sidebar when clicking outside on mobile\r\n-    document.addEventListener('click', function(event) {\r\n-      const sidebar = document.querySelector('.sidebar');\r\n-      const toggleBtn = document.querySelector('.toggle-btn');\r\n-      \r\n-      if (window.innerWidth <= 1024 && \r\n-          !sidebar.contains(event.target) && \r\n-          !toggleBtn.contains(event.target) && \r\n-          sidebar.classList.contains('active')) {\r\n-        sidebar.classList.remove('active');\r\n-      }\r\n-    });\r\n-  </script>\r\n-\r\n+  \r\n     <script>\r\n      let currentPage = parseInt(document.getElementById('currentPage').innerHTML);\r\n       let totalPages = parseInt(document.getElementById('totalPages').innerHTML);\r\n       let overallSalesCount = document.getElementById('overallSalesCount');\r\n"
                },
                {
                    "date": 1736311291977,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -97,10 +97,10 @@\n         margin-bottom: 1rem;\r\n       }\r\n     }\r\n   </style>\r\n-</head>\r\n-<body>\r\n+\r\n+\r\n   <button class=\"toggle-btn\" onclick=\"toggleSidebar()\">☰</button>\r\n   \r\n   <div class=\"sidebar\">\r\n     <!-- Sidebar content goes here -->\r\n@@ -194,9 +194,11 @@\n     </div>\r\n   </div>\r\n \r\n \r\n-  \r\n+\r\n+\r\n+\r\n     <script>\r\n      let currentPage = parseInt(document.getElementById('currentPage').innerHTML);\r\n       let totalPages = parseInt(document.getElementById('totalPages').innerHTML);\r\n       let overallSalesCount = document.getElementById('overallSalesCount');\r\n"
                },
                {
                    "date": 1736311298734,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -99,10 +99,11 @@\n     }\r\n   </style>\r\n \r\n \r\n-  <button class=\"toggle-btn\" onclick=\"toggleSidebar()\">☰</button>\r\n   \r\n+\r\n+  \r\n   <div class=\"sidebar\">\r\n     <!-- Sidebar content goes here -->\r\n   </div>\r\n \r\n"
                },
                {
                    "date": 1736311328192,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -262,9 +262,9 @@\n     \r\n         data.forEach(order => {\r\n           const row = document.createElement('tr');\r\n           row.innerHTML = `\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">${order.orderId}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${order.orderId}</td>\r\n             <td class=\"px-6 py-4 text-sm text-gray-600\">${order.userId.substring(0, 4) + '...' + order.userId.slice(-5)}</td>\r\n             <td class=\"px-6 py-4 text-sm text-gray-600\">${new Date(order.createdAt).toLocaleDateString('en-GB')}</td>\r\n             <td class=\"px-6 py-4 text-sm text-gray-600\">₹${order.payableAmount.toFixed(2)}</td>\r\n             <td class=\"px-6 py-4 text-sm text-gray-600\">₹${order.couponDiscount.toFixed(2)}</td>\r\n"
                },
                {
                    "date": 1736311394783,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,19 +13,9 @@\n       font-family: system-ui, -apple-system, sans-serif;\r\n       background-color: #f3f4f6;\r\n     }\r\n \r\n-    /* Sidebar styles */\r\n-    .sidebar {\r\n-      position: fixed;\r\n-      left: 0;\r\n-      top: 0;\r\n-      height: 100vh;\r\n-      width: 256px;\r\n-      background-color: #e6f3ff;\r\n-      transition: transform 0.3s ease;\r\n-      z-index: 40;\r\n-    }\r\n+  \r\n \r\n     /* Main content styles */\r\n     .main-content {\r\n       margin-left: 256px;\r\n@@ -263,15 +253,15 @@\n         data.forEach(order => {\r\n           const row = document.createElement('tr');\r\n           row.innerHTML = `\r\n             <td class=\"px-6 py-4 text-lg text-gray-600\">${order.orderId}</td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">${order.userId.substring(0, 4) + '...' + order.userId.slice(-5)}</td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">${new Date(order.createdAt).toLocaleDateString('en-GB')}</td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">₹${order.payableAmount.toFixed(2)}</td>\r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">₹${order.couponDiscount.toFixed(2)}</td>\r\n-          <td class=\"px-6 py-4 text-sm text-gray-600\">${order.status}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${order.userId.substring(0, 4) + '...' + order.userId.slice(-5)}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${new Date(order.createdAt).toLocaleDateString('en-GB')}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">₹${order.payableAmount.toFixed(2)}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">₹${order.couponDiscount.toFixed(2)}</td>\r\n+          <td class=\"px-6 py-4 text-lg text-gray-600\">${order.status}</td>\r\n \r\n-            <td class=\"px-6 py-4 text-sm text-gray-600\">${order.paymentMethod}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${order.paymentMethod}</td>\r\n          \r\n           `;\r\n           tBody.appendChild(row);\r\n         });\r\n"
                },
                {
                    "date": 1736311453187,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n   <style>\r\n     /* Base styles */\r\n     body {\r\n       margin: 0;\r\n-      font-family: system-ui, -apple-system, sans-serif;\r\n+      font-family: 'Montserrat', 'Arial', sans-serif;\r\n       background-color: #f3f4f6;\r\n     }\r\n \r\n   \r\n"
                },
                {
                    "date": 1736311459312,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,8 +10,9 @@\n     /* Base styles */\r\n     body {\r\n       margin: 0;\r\n       font-family: 'Montserrat', 'Arial', sans-serif;\r\n+      font-weight: ;\r\n       background-color: #f3f4f6;\r\n     }\r\n \r\n   \r\n"
                },
                {
                    "date": 1736311501893,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,18 +1,14 @@\n \r\n <%- include('sidebar.ejs') %>\r\n-<!DOCTYPE html>\r\n-<html lang=\"en\">\r\n-<head>\r\n-  <meta charset=\"UTF-8\">\r\n-  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+\r\n   <title>Sales Report</title>\r\n   <style>\r\n     /* Base styles */\r\n     body {\r\n       margin: 0;\r\n       font-family: 'Montserrat', 'Arial', sans-serif;\r\n-      font-weight: ;\r\n+      font-weight: 700;\r\n       background-color: #f3f4f6;\r\n     }\r\n \r\n   \r\n"
                },
                {
                    "date": 1736311507827,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -20,22 +20,9 @@\n       min-height: 100vh;\r\n       background-color: #f3f4f6;\r\n     }\r\n \r\n-    /* Toggle button */\r\n-    .toggle-btn {\r\n-      display: none;\r\n-      position: fixed;\r\n-      top: 1rem;\r\n-      left: 1rem;\r\n-      z-index: 50;\r\n-      padding: 0.5rem;\r\n-      background-color: #3b82f6;\r\n-      color: white;\r\n-      border: none;\r\n-      border-radius: 0.375rem;\r\n-      cursor: pointer;\r\n-    }\r\n+ \r\n \r\n     /* Stats cards */\r\n     .stats-card {\r\n       background-color: #e6f3ff;\r\n"
                },
                {
                    "date": 1736311516550,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,10 +76,8 @@\n \r\n   \r\n \r\n   \r\n-  <div class=\"sidebar\">\r\n-    <!-- Sidebar content goes here -->\r\n   </div>\r\n \r\n   <div class=\"main-content\">\r\n     <div class=\"container mx-auto px-4 py-8\">\r\n"
                },
                {
                    "date": 1736311528918,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,9 +76,9 @@\n \r\n   \r\n \r\n   \r\n-  </div>\r\n+  \r\n \r\n   <div class=\"main-content\">\r\n     <div class=\"container mx-auto px-4 py-8\">\r\n       <div class=\"mb-6\">\r\n"
                },
                {
                    "date": 1736311564790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,341 @@\n+\r\n+<%- include('sidebar.ejs') %>\r\n+\r\n+  <title>Sales Report</title>\r\n+  <style>\r\n+    /* Base styles */\r\n+    body {\r\n+      margin: 0;\r\n+      font-family: 'Montserrat', 'Arial', sans-serif;\r\n+      font-weight: 700;\r\n+      background-color: #f3f4f6;\r\n+    }\r\n+\r\n+  \r\n+\r\n+    /* Main content styles */\r\n+    .main-content {\r\n+      margin-left: 256px;\r\n+      transition: margin-left 0.3s ease;\r\n+      min-height: 100vh;\r\n+      background-color: #f3f4f6;\r\n+    }\r\n+\r\n+ \r\n+\r\n+    /* Stats cards */\r\n+    .stats-card {\r\n+      background-color: #e6f3ff;\r\n+      padding: 1.25rem;\r\n+      border-radius: 0.5rem;\r\n+      flex: 1;\r\n+      text-align: center;\r\n+      transition: background-color 0.3s;\r\n+    }\r\n+\r\n+    .stats-card:hover {\r\n+      background-color: #bfdbfe;\r\n+    }\r\n+\r\n+    /* Table styles */\r\n+    .table-container {\r\n+      background-color: white;\r\n+      border-radius: 0.5rem;\r\n+      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n+      overflow-x: auto;\r\n+    }\r\n+\r\n+    /* Responsive styles */\r\n+    @media (max-width: 1024px) {\r\n+      .sidebar {\r\n+        transform: translateX(-100%);\r\n+      }\r\n+      \r\n+      .sidebar.active {\r\n+        transform: translateX(0);\r\n+      }\r\n+\r\n+      .main-content {\r\n+        margin-left: 0;\r\n+      }\r\n+\r\n+      .toggle-btn {\r\n+        display: block;\r\n+      }\r\n+\r\n+      .stats-container {\r\n+        flex-direction: column;\r\n+      }\r\n+\r\n+      .stats-card {\r\n+        margin-bottom: 1rem;\r\n+      }\r\n+    }\r\n+  </style>\r\n+\r\n+\r\n+  \r\n+\r\n+  \r\n+\r\n+\r\n+  <div class=\"main-content\">\r\n+    <div class=\"container mx-auto px-4 py-8\">\r\n+      <div class=\"mb-6\">\r\n+        <div class=\"flex flex-wrap justify-between items-center mb-6\">\r\n+          <h1 style=\"font-size: 1.5rem; font-weight: 600; color: #1f2937;\">Sales Report</h1>\r\n+          \r\n+          <div class=\"flex flex-wrap gap-4 mt-4 sm:mt-0\">\r\n+            <select id=\"filterOption\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white;\">\r\n+              <option value=\"\">Filter</option>\r\n+              <option value=\"day\">This Day</option>\r\n+              <option value=\"week\">This Week</option>\r\n+              <option value=\"month\">This Month</option>\r\n+              <option value=\"year\">This Year</option>\r\n+            </select>\r\n+            \r\n+            <select id=\"export\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white;\">\r\n+              <option value=\"\">Export Report</option>\r\n+              <option value=\"excel\">Excel Sheet</option>\r\n+              <option value=\"pdf\">PDF</option>\r\n+            </select>\r\n+          </div>\r\n+        </div>\r\n+      </div>\r\n+\r\n+      <div class=\"flex flex-wrap gap-4 my-6\">\r\n+        <div class=\"stats-card\">\r\n+          <span style=\"font-size: 0.75rem; text-transform: uppercase; color: #6b7280;\">Overall Sales Count</span>\r\n+          <span id=\"overallSalesCount\" style=\"display: block; font-size: 1.5rem; font-weight: 600; margin-top: 0.25rem;\"><%= overallSalesCount %></span>\r\n+        </div>\r\n+        \r\n+        <div class=\"stats-card\">\r\n+          <span style=\"font-size: 0.75rem; text-transform: uppercase; color: #6b7280;\">Overall Order Amount</span>\r\n+          <span id=\"overallOrderAmount\" style=\"display: block; font-size: 1.5rem; font-weight: 600; margin-top: 0.25rem;\">₹ <%= overallOrderAmount.toFixed(2) %></span>\r\n+        </div>\r\n+        \r\n+        <div class=\"stats-card\">\r\n+          <span style=\"font-size: 0.75rem; text-transform: uppercase; color: #6b7280;\">Overall Coupon Discount</span>\r\n+          <span id=\"totalCouponDiscount\" style=\"display: block; font-size: 1.5rem; font-weight: 600; margin-top: 0.25rem;\">₹ <%= totalCouponDiscount.toFixed(2) %></span>\r\n+        </div>\r\n+      </div>\r\n+\r\n+      <div class=\"table-container\">\r\n+        <table style=\"min-width: 100%; border-collapse: separate; border-spacing: 0;\">\r\n+          <thead style=\"background-color: #f9fafb;\">\r\n+            <tr>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Order ID</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">User ID</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Order Date</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Order Amount</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Coupon Deduction</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Payment Status</th>\r\n+              <th style=\"padding: 0.75rem 1.5rem; text-align: left; font-size: 0.75rem; font-weight: 500; color: #6b7280; text-transform: uppercase;\">Payment Method</th>\r\n+            </tr>\r\n+          </thead>\r\n+          <tbody>\r\n+            <% data.forEach(data =>{ %>\r\n+            <tr style=\"border-bottom: 1px solid #e5e7eb;\">\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.orderId %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.userId.toString().substring(0, 4) + '...' + data.userId.toString().slice(-5) %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= new Date(data.createdAt).toLocaleDateString('en-GB') %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\">₹ <%= data.payableAmount.toFixed(2) %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\">₹ <%= data.couponDiscount.toFixed(2) %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.status %></td>\r\n+              <td style=\"padding: 1rem 1.5rem; font-size: 0.875rem; color: #4b5563;\"><%= data.paymentMethod %></td>\r\n+            </tr>\r\n+            <% }) %>\r\n+          </tbody>\r\n+        </table>\r\n+      </div>\r\n+\r\n+      <div class=\"flex flex-wrap justify-between items-center mt-6\">\r\n+        <div style=\"font-size: 0.875rem; color: #4b5563;\">\r\n+          Showing <span style=\"font-weight: 500;\" id=\"currentPage\"><%= currentPage %></span> to \r\n+          <span style=\"font-weight: 500;\" id=\"totalPages\"><%= totalPages %></span> of \r\n+          <span style=\"font-weight: 500;\" id=\"totalRecords\"><%= totalRecordsCount %></span> results\r\n+        </div>\r\n+        <div class=\"flex gap-2 mt-4 sm:mt-0\">\r\n+          <button id=\"prevPage\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; color: #4b5563;\">\r\n+            Previous\r\n+          </button>\r\n+          <button id=\"nextPage\" style=\"padding: 0.5rem 1rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; color: #4b5563;\">\r\n+            Next\r\n+          </button>\r\n+        </div>\r\n+      </div>\r\n+    </div>\r\n+  </div>\r\n+\r\n+\r\n+\r\n+\r\n+\r\n+    <script>\r\n+     let currentPage = parseInt(document.getElementById('currentPage').innerHTML);\r\n+      let totalPages = parseInt(document.getElementById('totalPages').innerHTML);\r\n+      let overallSalesCount = document.getElementById('overallSalesCount');\r\n+      let overallOrderAmount = document.getElementById('overallOrderAmount');\r\n+      let totalCouponDiscount = document.getElementById('totalCouponDiscount');\r\n+    \r\n+      \r\n+      \r\n+    \r\n+    \r\n+      console.log(\"current \", currentPage);\r\n+      console.log(\"Total \", totalPages);\r\n+      \r\n+    \r\n+      // Fetch Sales Report\r\n+      function fetchSalesReport(page, filterOption = '') {\r\n+        console.log(\"page in fetchSalesReport = \",page);\r\n+        \r\n+        const URL = `/admin/salesReport?page=${page}&filter=${filterOption}`;\r\n+    \r\n+        fetch(URL, {\r\n+          headers: {\r\n+            'Accept': 'application/json',\r\n+          },\r\n+        })\r\n+        .then(response => {\r\n+          if (!response.ok) {\r\n+            throw new Error(`Server error: ${response.status}`);\r\n+          }\r\n+          return response.json();\r\n+        })\r\n+        .then(data => {\r\n+          console.log(data)\r\n+          overallSalesCount.innerHTML = ''\r\n+          overallSalesCount.innerHTML = data.overallSalesCount\r\n+          overallOrderAmount.innerHTML = ''\r\n+          overallOrderAmount.innerHTML = `₹${data.overallOrderAmount.toFixed(2)}`;\r\n+          totalCouponDiscount.innerHTML = ''\r\n+          totalCouponDiscount.innerHTML = `₹${data.totalCouponDiscount.toFixed(2)}`;\r\n+          \r\n+          \r\n+    \r\n+          updateReportTable(data.data);\r\n+          updatePagination(data.currentPage, data.totalPages, data.totalRecordsCount);\r\n+        })\r\n+        .catch(error => console.error('Error fetching sales report:', error));\r\n+      }\r\n+    \r\n+      // Event listener for Filter dropdown\r\n+      document.getElementById('filterOption').addEventListener('change', function (event) {\r\n+        const selectedFilter = event.target.value;\r\n+        \r\n+        fetchSalesReport(1, selectedFilter);\r\n+      });\r\n+    \r\n+      // Update the table rows\r\n+      function updateReportTable(data) {\r\n+        const tBody = document.querySelector('tbody');\r\n+        tBody.innerHTML = '';  // Clear previous rows\r\n+    \r\n+        data.forEach(order => {\r\n+          const row = document.createElement('tr');\r\n+          row.innerHTML = `\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${order.orderId}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${order.userId.substring(0, 4) + '...' + order.userId.slice(-5)}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${new Date(order.createdAt).toLocaleDateString('en-GB')}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">₹${order.payableAmount.toFixed(2)}</td>\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">₹${order.couponDiscount.toFixed(2)}</td>\r\n+          <td class=\"px-6 py-4 text-lg text-gray-600\">${order.status}</td>\r\n+\r\n+            <td class=\"px-6 py-4 text-lg text-gray-600\">${order.paymentMethod}</td>\r\n+         \r\n+          `;\r\n+          tBody.appendChild(row);\r\n+        });\r\n+      }\r\n+    \r\n+      // Update pagination buttons and info\r\n+      function updatePagination(current, total, totalRecords) {\r\n+        currentPage = current;\r\n+        totalPages = total;\r\n+    \r\n+        document.getElementById('currentPage').innerText = current;\r\n+        document.getElementById('totalPages').innerText = total;\r\n+        document.getElementById('totalRecords').innerText = totalRecords;\r\n+    \r\n+        document.getElementById('prevPage').disabled = currentPage === 1;\r\n+        document.getElementById('nextPage').disabled = currentPage === totalPages;\r\n+      }\r\n+    \r\n+      document.getElementById('prevPage').addEventListener('click', function () {\r\n+        if (currentPage > 1) {\r\n+          fetchSalesReport(currentPage - 1);\r\n+        }\r\n+      });\r\n+    \r\n+      document.getElementById('nextPage').addEventListener('click', function () {\r\n+        console.log(\"Ima next\");\r\n+        console.log(\"tottal pages = \",totalPages);\r\n+        console.log(\"currentPage page = \",currentPage);\r\n+        \r\n+        \r\n+        \r\n+        if (currentPage < totalPages) {\r\n+          fetchSalesReport(currentPage + 1);\r\n+        }\r\n+      });\r\n+    \r\n+    \r\n+      \r\n+    //--------------Report generation -------------------\r\n+    \r\n+    document.getElementById('export').addEventListener('change',function(event){\r\n+        const selectedExport = event.target.value;\r\n+    \r\n+        if(selectedExport){\r\n+            const filterOption = document.getElementById('filterOption').value;\r\n+    \r\n+           exportReport(selectedExport,filterOption)\r\n+            \r\n+    \r\n+        }\r\n+    })\r\n+    \r\n+    \r\n+    function exportReport(format,filterOption){\r\n+    \r\n+    \r\n+        const URL = `/admin/exportReport?format=${format}&filter=${filterOption}`\r\n+    \r\n+        fetch(URL,{\r\n+            headers:{\r\n+                'Accept':'application/json'\r\n+            }\r\n+        })\r\n+        .then(response=>response.blob())\r\n+        .then(blob=>{\r\n+    \r\n+            const url = window.URL.createObjectURL(blob);\r\n+            const a = document.createElement('a');\r\n+            a.href = url\r\n+    \r\n+            //file name\r\n+    \r\n+            a.download = `sales_report.${format === 'excel' ? 'xlsx' : 'pdf'}`;\r\n+    \r\n+            document.body.appendChild(a)\r\n+            a.click();\r\n+            a.remove();\r\n+         \r\n+    \r\n+        })\r\n+        .catch(error=>console.error('Error exporting report:', error))\r\n+    \r\n+    \r\n+    }\r\n+    \r\n+    \r\n+    \r\n+    \r\n+    \r\n+    \r\n+    \r\n+    \r\n+    \r\n+    \r\n+    </script>\r\n"
                }
            ],
            "date": 1736310863953,
            "name": "Commit-0",
            "content": "\r\n\r\n<div class=\"flex ml-64\">\r\n \r\n  \r\n  <div class=\"container mx-auto px-4 py-8 flex-1\">\r\n    <div class=\"mb-6\">\r\n      <div class=\"flex justify-between items-center mb-6\">\r\n        <h1 class=\"text-2xl font-semibold text-gray-800\">Sales Report</h1>\r\n        \r\n        <div class=\"flex gap-4\">\r\n          <!-- Filter Dropdown -->\r\n          <div class=\"relative\">\r\n            <select id=\"filterOption\" class=\"bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n              <option value=\"\">Filter</option>\r\n              <option value=\"day\">This Day</option>\r\n              <option value=\"week\">This Week</option>\r\n              <option value=\"month\">This Month</option>\r\n              <option value=\"year\">This Year</option>\r\n            </select>\r\n          </div>\r\n          \r\n          <!-- Export Dropdown -->\r\n          <div class=\"relative\">\r\n            <select id=\"export\" class=\"bg-white border border-gray-300 text-gray-700 px-4 py-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n              <option value=\"\">Export Report</option>\r\n              <option value=\"excel\">Excel Sheet</option>\r\n              <option value=\"pdf\">PDF</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"bg-white h-28 flex justify-between items-center my-6 px-4 py-5 shadow-lg rounded-lg space-x-6\">\r\n      <div class=\"flex-1 px-5 py-3 bg-gray-100 rounded-md flex flex-col justify-center items-center text-gray-700 font-medium shadow-sm hover:bg-gray-200 transition duration-300 ease-in-out\">\r\n        <span class=\"text-xs uppercase tracking-wider text-gray-500\">Overall Sales Count</span>\r\n        <span id=\"overallSalesCount\" class=\"text-2xl font-semibold mt-1\"><%= overallSalesCount %></span>\r\n      </div>\r\n      <div class=\"flex-1 px-5 py-3 bg-gray-100 rounded-md flex flex-col justify-center items-center text-gray-700 font-medium shadow-sm hover:bg-gray-200 transition duration-300 ease-in-out\">\r\n        <span class=\"text-xs uppercase tracking-wider text-gray-500\">Overall Order Amount</span>\r\n        <span id=\"overallOrderAmount\" class=\"text-2xl font-semibold mt-1\">₹ <%= overallOrderAmount.toFixed(2) %></span>\r\n      </div>\r\n      <div class=\"flex-1 px-5 py-3 bg-gray-100 rounded-md flex flex-col justify-center items-center text-gray-700 font-medium shadow-sm hover:bg-gray-200 transition duration-300 ease-in-out\">\r\n        <span class=\"text-xs uppercase tracking-wider text-gray-500\">Overall Coupon Discount</span>\r\n        <span id=\"totalCouponDiscount\" class=\"text-2xl font-semibold mt-1\">₹ <%= totalCouponDiscount.toFixed(2) %></span>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Sales Report Table -->\r\n    <div class=\"bg-white rounded-lg shadow-md overflow-x-auto\">\r\n      <table class=\"min-w-full divide-y divide-gray-200\">\r\n        <thead class=\"bg-gray-50\">\r\n          <tr>\r\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Order ID</th>\r\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">User ID</th>\r\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Order Date</th>\r\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Order Amount</th>\r\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Coupon Deduction</th>\r\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Payment Status</th>\r\n            <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Payment Method</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"bg-white divide-y divide-gray-200\">\r\n          <% data.forEach(data =>{ %>\r\n          <tr class=\"hover:bg-gray-50\">\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= data.orderId %></td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= data.userId.toString().substring(0, 4) + '...' + data.userId.toString().slice(-5) %></td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= new Date(data.createdAt).toLocaleDateString('en-GB') %></td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">₹ <%= data.payableAmount.toFixed(2) %></td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">₹ <%= data.couponDiscount.toFixed(2) %></td>\r\n            <td class=\"px-6 py-4 text-sm\">\r\n              <span class=\"<%= data.status === 'Paid'%>px-6 py-4 text-sm text-gray-600\">\r\n                <%= data.status %>\r\n              </span>\r\n            </td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\"><%= data.paymentMethod %></td>\r\n   \r\n          </tr>\r\n          <% }) %>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <!-- Pagination -->\r\n    <div class=\"flex justify-between items-center mt-6\">\r\n      <div class=\"text-sm text-gray-600\">\r\n        Showing <span class=\"font-medium\" id=\"currentPage\"><%= currentPage %></span> to \r\n        <span class=\"font-medium\" id=\"totalPages\"><%= totalPages %></span> of \r\n        <span class=\"font-medium\" id=\"totalRecords\"><%= totalRecordsCount %></span> results\r\n      </div>\r\n      <div class=\"inline-flex gap-2\">\r\n        <button id=\"prevPage\" class=\"px-4 py-2 border border-gray-300 rounded-md text-gray-600 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n          Previous\r\n        </button>\r\n        <button id=\"nextPage\" class=\"px-4 py-2 border border-gray-300 rounded-md text-gray-600 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\">\r\n          Next\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n    <script>\r\n     let currentPage = parseInt(document.getElementById('currentPage').innerHTML);\r\n      let totalPages = parseInt(document.getElementById('totalPages').innerHTML);\r\n      let overallSalesCount = document.getElementById('overallSalesCount');\r\n      let overallOrderAmount = document.getElementById('overallOrderAmount');\r\n      let totalCouponDiscount = document.getElementById('totalCouponDiscount');\r\n    \r\n      \r\n      \r\n    \r\n    \r\n      console.log(\"current \", currentPage);\r\n      console.log(\"Total \", totalPages);\r\n      \r\n    \r\n      // Fetch Sales Report\r\n      function fetchSalesReport(page, filterOption = '') {\r\n        console.log(\"page in fetchSalesReport = \",page);\r\n        \r\n        const URL = `/admin/salesReport?page=${page}&filter=${filterOption}`;\r\n    \r\n        fetch(URL, {\r\n          headers: {\r\n            'Accept': 'application/json',\r\n          },\r\n        })\r\n        .then(response => {\r\n          if (!response.ok) {\r\n            throw new Error(`Server error: ${response.status}`);\r\n          }\r\n          return response.json();\r\n        })\r\n        .then(data => {\r\n          console.log(data)\r\n          overallSalesCount.innerHTML = ''\r\n          overallSalesCount.innerHTML = data.overallSalesCount\r\n          overallOrderAmount.innerHTML = ''\r\n          overallOrderAmount.innerHTML = `₹${data.overallOrderAmount.toFixed(2)}`;\r\n          totalCouponDiscount.innerHTML = ''\r\n          totalCouponDiscount.innerHTML = `₹${data.totalCouponDiscount.toFixed(2)}`;\r\n          \r\n          \r\n    \r\n          updateReportTable(data.data);\r\n          updatePagination(data.currentPage, data.totalPages, data.totalRecordsCount);\r\n        })\r\n        .catch(error => console.error('Error fetching sales report:', error));\r\n      }\r\n    \r\n      // Event listener for Filter dropdown\r\n      document.getElementById('filterOption').addEventListener('change', function (event) {\r\n        const selectedFilter = event.target.value;\r\n        \r\n        fetchSalesReport(1, selectedFilter);\r\n      });\r\n    \r\n      // Update the table rows\r\n      function updateReportTable(data) {\r\n        const tBody = document.querySelector('tbody');\r\n        tBody.innerHTML = '';  // Clear previous rows\r\n    \r\n        data.forEach(order => {\r\n          const row = document.createElement('tr');\r\n          row.innerHTML = `\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">${order.orderId}</td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">${order.userId.substring(0, 4) + '...' + order.userId.slice(-5)}</td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">${new Date(order.createdAt).toLocaleDateString('en-GB')}</td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">₹${order.payableAmount.toFixed(2)}</td>\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">₹${order.couponDiscount.toFixed(2)}</td>\r\n          <td class=\"px-6 py-4 text-sm text-gray-600\">${order.status}</td>\r\n\r\n            <td class=\"px-6 py-4 text-sm text-gray-600\">${order.paymentMethod}</td>\r\n         \r\n          `;\r\n          tBody.appendChild(row);\r\n        });\r\n      }\r\n    \r\n      // Update pagination buttons and info\r\n      function updatePagination(current, total, totalRecords) {\r\n        currentPage = current;\r\n        totalPages = total;\r\n    \r\n        document.getElementById('currentPage').innerText = current;\r\n        document.getElementById('totalPages').innerText = total;\r\n        document.getElementById('totalRecords').innerText = totalRecords;\r\n    \r\n        document.getElementById('prevPage').disabled = currentPage === 1;\r\n        document.getElementById('nextPage').disabled = currentPage === totalPages;\r\n      }\r\n    \r\n      document.getElementById('prevPage').addEventListener('click', function () {\r\n        if (currentPage > 1) {\r\n          fetchSalesReport(currentPage - 1);\r\n        }\r\n      });\r\n    \r\n      document.getElementById('nextPage').addEventListener('click', function () {\r\n        console.log(\"Ima next\");\r\n        console.log(\"tottal pages = \",totalPages);\r\n        console.log(\"currentPage page = \",currentPage);\r\n        \r\n        \r\n        \r\n        if (currentPage < totalPages) {\r\n          fetchSalesReport(currentPage + 1);\r\n        }\r\n      });\r\n    \r\n    \r\n      \r\n    //--------------Report generation -------------------\r\n    \r\n    document.getElementById('export').addEventListener('change',function(event){\r\n        const selectedExport = event.target.value;\r\n    \r\n        if(selectedExport){\r\n            const filterOption = document.getElementById('filterOption').value;\r\n    \r\n           exportReport(selectedExport,filterOption)\r\n            \r\n    \r\n        }\r\n    })\r\n    \r\n    \r\n    function exportReport(format,filterOption){\r\n    \r\n    \r\n        const URL = `/admin/exportReport?format=${format}&filter=${filterOption}`\r\n    \r\n        fetch(URL,{\r\n            headers:{\r\n                'Accept':'application/json'\r\n            }\r\n        })\r\n        .then(response=>response.blob())\r\n        .then(blob=>{\r\n    \r\n            const url = window.URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url\r\n    \r\n            //file name\r\n    \r\n            a.download = `sales_report.${format === 'excel' ? 'xlsx' : 'pdf'}`;\r\n    \r\n            document.body.appendChild(a)\r\n            a.click();\r\n            a.remove();\r\n         \r\n    \r\n        })\r\n        .catch(error=>console.error('Error exporting report:', error))\r\n    \r\n    \r\n    }\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    </script>\r\n"
        }
    ]
}